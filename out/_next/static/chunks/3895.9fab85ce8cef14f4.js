"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3895,9406],{9406:function(t,e,a){a.d(e,{Eo:function(){return h},loadGifImage:function(){return c}});const i=[0,4,2,1],o=[8,8,4,2];class n{constructor(t){this.pos=0,this.data=new Uint8ClampedArray(t)}getString(t){const e=this.data.slice(this.pos,this.pos+t);return this.pos+=e.length,e.reduce(((t,e)=>t+String.fromCharCode(e)),"")}nextByte(){return this.data[this.pos++]}nextTwoBytes(){return this.pos+=2,this.data[this.pos-2]+(this.data[this.pos-1]<<8)}readSubBlocks(){let t="",e=0;do{e=this.data[this.pos++];for(let a=e;--a>=0;t+=String.fromCharCode(this.data[this.pos++]));}while(0!==e);return t}readSubBlocksBin(){let t=this.data[this.pos],e=0;for(let i=0;0!==t;i+=t+1,t=this.data[this.pos+i])e+=t;const a=new Uint8Array(e);t=this.data[this.pos++];for(let i=0;0!==t;t=this.data[this.pos++])for(let e=t;--e>=0;a[i++]=this.data[this.pos++]);return a}skipSubBlocks(){for(const t=1,e=0;this.data[this.pos]!==e;this.pos+=this.data[this.pos]+t);this.pos++}}const s=0,r=0;function l(t,e){const a=[];for(let i=0;i<e;i++)a.push({r:t.data[t.pos],g:t.data[t.pos+1],b:t.data[t.pos+2]}),t.pos+=3;return a}async function g(t,e,a,n,s,r){switch(t.nextByte()){case 59:return!0;case 44:await async function(t,e,a,n,s,r){const g=e.frames[n(!0)];g.left=t.nextTwoBytes(),g.top=t.nextTwoBytes(),g.width=t.nextTwoBytes(),g.height=t.nextTwoBytes();const h=t.nextByte(),c=128===(128&h),f=64===(64&h);g.sortFlag=32===(32&h),g.reserved=(24&h)>>>3;const d=1<<1+(7&h);c&&(g.localColorTable=l(t,d));const p=t=>{const{r:i,g:o,b:n}=(c?g.localColorTable:e.globalColorTable)[t];return t!==s(null)?{r:i,g:o,b:n,a:255}:{r:i,g:o,b:n,a:a?~~((i+o+n)/3):0}},m=(()=>{try{return new ImageData(g.width,g.height,{colorSpace:"srgb"})}catch(t){if(t instanceof DOMException&&"IndexSizeError"===t.name)return null;throw t}})();if(null==m)throw new EvalError("GIF frame size is to large");const u=t.nextByte(),w=t.readSubBlocksBin(),b=1<<u,y=(t,e)=>{const a=t>>>3,i=7&t;return(w[a]+(w[a+1]<<8)+(w[a+2]<<16)&(1<<e)-1<<i)>>>i};if(f){for(let a=0,s=u+1,l=0,h=[[0]],c=0;c<4;c++){if(i[c]<g.height){let t=0,e=0,n=!1;for(;!n;){const r=a;if(a=y(l,s),l+=s+1,a===b){s=u+1,h.length=b+2;for(let t=0;t<h.length;t++)h[t]=t<b?[t]:[]}else{a>=h.length?h.push(h[r].concat(h[r][0])):r!==b&&h.push(h[r].concat(h[a][0]));for(const n of h[a]){const{r:a,g:s,b:r,a:l}=p(n);m.data.set([a,s,r,l],i[c]*g.width+o[c]*e+t%(4*g.width)),t+=4}h.length===1<<s&&s<12&&s++}t===4*g.width*(e+1)&&(e++,i[c]+o[c]*e>=g.height&&(n=!0))}}r?.(t.pos/(t.data.length-1),n(!1)+1,m,{x:g.left,y:g.top},{width:e.width,height:e.height})}g.image=m,g.bitmap=await createImageBitmap(m)}else{let a=0,i=u+1,o=0,s=-4,l=!1;const h=[[0]];for(;!l;){const t=a;if(a=y(o,i),o+=i,a===b){i=u+1,h.length=b+2;for(let t=0;t<h.length;t++)h[t]=t<b?[t]:[]}else{if(a===b+1){l=!0;break}a>=h.length?h.push(h[t].concat(h[t][0])):t!==b&&h.push(h[t].concat(h[a][0]));for(const t of h[a]){const{r:e,g:a,b:i,a:o}=p(t);m.data.set([e,a,i,o],s+=4)}h.length>=1<<i&&i<12&&i++}}g.image=m,g.bitmap=await createImageBitmap(m),r?.((t.pos+1)/t.data.length,n(!1)+1,g.image,{x:g.left,y:g.top},{width:e.width,height:e.height})}}(t,e,a,n,s,r);break;case 33:!function(t,e,a,i){switch(t.nextByte()){case 249:{const o=e.frames[a(!1)];t.pos++;const n=t.nextByte();o.GCreserved=(224&n)>>>5,o.disposalMethod=(28&n)>>>2,o.userInputDelayFlag=2===(2&n);const s=1===(1&n);o.delayTime=10*t.nextTwoBytes();const r=t.nextByte();s&&i(r),t.pos++;break}case 255:{t.pos++;const a={identifier:t.getString(8),authenticationCode:t.getString(3),data:t.readSubBlocksBin()};e.applicationExtensions.push(a);break}case 254:e.comments.push([a(!1),t.readSubBlocks()]);break;case 1:if(0===e.globalColorTable.length)throw new EvalError("plain text extension without global color table");t.pos++,e.frames[a(!1)].plainTextData={left:t.nextTwoBytes(),top:t.nextTwoBytes(),width:t.nextTwoBytes(),height:t.nextTwoBytes(),charSize:{width:t.nextTwoBytes(),height:t.nextTwoBytes()},foregroundColor:t.nextByte(),backgroundColor:t.nextByte(),text:t.readSubBlocks()};break;default:t.skipSubBlocks()}}(t,e,n,s);break;default:throw new EvalError("undefined block found")}return!1}function h(t){const{context:e,radius:a,particle:i,delta:o}=t,n=i.image;if(!n?.gifData||!n.gif)return;const l=new OffscreenCanvas(n.gifData.width,n.gifData.height),g=l.getContext("2d");if(!g)throw new Error("could not create offscreen canvas context");g.imageSmoothingQuality="low",g.imageSmoothingEnabled=!1,g.clearRect(s,r,l.width,l.height),void 0===i.gifLoopCount&&(i.gifLoopCount=n.gifLoopCount??0);let h=i.gifFrame??0;const c={x:.5*-n.gifData.width,y:.5*-n.gifData.height},f=n.gifData.frames[h];if(void 0===i.gifTime&&(i.gifTime=0),f.bitmap){switch(e.scale(a/n.gifData.width,a/n.gifData.height),f.disposalMethod){case 4:case 5:case 6:case 7:case 0:g.drawImage(f.bitmap,f.left,f.top),e.drawImage(l,c.x,c.y),g.clearRect(s,r,l.width,l.height);break;case 1:g.drawImage(f.bitmap,f.left,f.top),e.drawImage(l,c.x,c.y);break;case 2:g.drawImage(f.bitmap,f.left,f.top),e.drawImage(l,c.x,c.y),g.clearRect(s,r,l.width,l.height),n.gifData.globalColorTable.length?g.putImageData(n.gifData.backgroundImage,c.x,c.y):g.putImageData(n.gifData.frames[0].image,c.x+f.left,c.y+f.top);break;case 3:{const t=g.getImageData(s,r,l.width,l.height);g.drawImage(f.bitmap,f.left,f.top),e.drawImage(l,c.x,c.y),g.clearRect(s,r,l.width,l.height),g.putImageData(t,s,r)}}if(i.gifTime+=o.value,i.gifTime>f.delayTime){if(i.gifTime-=f.delayTime,++h>=n.gifData.frames.length){if(--i.gifLoopCount<=0)return;h=0,g.clearRect(s,r,l.width,l.height)}i.gifFrame=h}e.scale(n.gifData.width/a,n.gifData.height/a)}}async function c(t){if("gif"===t.type){t.loading=!0;try{t.gifData=await async function(t,e,a){a||(a=!1);const i=await fetch(t);if(!i.ok&&404===i.status)throw new EvalError("file not found");const o=await i.arrayBuffer(),s={width:0,height:0,totalTime:0,colorRes:0,pixelAspectRatio:0,frames:[],sortFlag:!1,globalColorTable:[],backgroundImage:new ImageData(1,1,{colorSpace:"srgb"}),comments:[],applicationExtensions:[]},r=new n(new Uint8ClampedArray(o));if("GIF89a"!==r.getString(6))throw new Error("not a supported GIF file");s.width=r.nextTwoBytes(),s.height=r.nextTwoBytes();const h=r.nextByte(),c=128===(128&h);s.colorRes=(112&h)>>>4,s.sortFlag=8===(8&h);const f=1<<1+(7&h),d=r.nextByte();s.pixelAspectRatio=r.nextByte(),0!==s.pixelAspectRatio&&(s.pixelAspectRatio=(s.pixelAspectRatio+15)/64),c&&(s.globalColorTable=l(r,f));const p=(()=>{try{return new ImageData(s.width,s.height,{colorSpace:"srgb"})}catch(t){if(t instanceof DOMException&&"IndexSizeError"===t.name)return null;throw t}})();if(null==p)throw new Error("GIF frame size is to large");const{r:m,g:u,b:w}=s.globalColorTable[d];p.data.set(c?[m,u,w,255]:[0,0,0,0]);for(let n=4;n<p.data.length;n*=2)p.data.copyWithin(n,0,n);s.backgroundImage=p;let b=-1,y=!0,x=-1;const C=t=>(t&&(y=!0),b),I=t=>(null!=t&&(x=t),x);try{do{y&&(s.frames.push({left:0,top:0,width:0,height:0,disposalMethod:0,image:new ImageData(1,1,{colorSpace:"srgb"}),plainTextData:null,userInputDelayFlag:!1,delayTime:0,sortFlag:!1,localColorTable:[],reserved:0,GCreserved:0}),b++,x=-1,y=!1)}while(!(await g(r,s,a,C,I,e)));s.frames.length--;for(const t of s.frames){if(t.userInputDelayFlag&&0===t.delayTime){s.totalTime=1/0;break}s.totalTime+=t.delayTime}return s}catch(T){if(T instanceof EvalError)throw new Error(`error while parsing frame ${b} "${T.message}"`);throw T}}(t.source),t.gifLoopCount=function(t){for(const e of t.applicationExtensions)if(e.identifier+e.authenticationCode==="NETSCAPE2.0")return e.data[1]+(e.data[2]<<8);return NaN}(t.gifData)??0,t.gifLoopCount||(t.gifLoopCount=1/0)}catch{t.error=!0}t.loading=!1}else{const{loadImage:e}=await Promise.resolve().then(a.bind(a,7297));await e(t)}}},4144:function(t,e,a){a.d(e,{ImageDrawer:function(){return s}});var i=a(2060),o=a(7297),n=a(9406);class s{constructor(t){this.loadImageShape=async t=>{if(!this._engine.loadImage)throw new Error(`${i.gK} image shape not initialized`);await this._engine.loadImage({gif:t.gif,name:t.name,replaceColor:t.replaceColor??!1,src:t.src})},this._engine=t}addImage(t){this._engine.images||(this._engine.images=[]),this._engine.images.push(t)}draw(t){const{context:e,radius:a,particle:i,opacity:o}=t,s=i.image,r=s?.element;if(s){if(e.globalAlpha=o,s.gif&&s.gifData)(0,n.Eo)(t);else if(r){const t=s.ratio,i={x:-a,y:-a},o=2*a;e.drawImage(r,i.x,i.y,o,o/t)}e.globalAlpha=1}}getSidesCount(){return 12}async init(t){const e=t.actualOptions;if(e.preload&&this._engine.loadImage)for(const a of e.preload)await this._engine.loadImage(a)}loadShape(t){if("image"!==t.shape&&"images"!==t.shape)return;this._engine.images||(this._engine.images=[]);const e=t.shapeData;if(!e)return;this._engine.images.find((t=>t.name===e.name||t.source===e.src))||this.loadImageShape(e).then((()=>{this.loadShape(t)}))}particleInit(t,e){if("image"!==e.shape&&"images"!==e.shape)return;this._engine.images||(this._engine.images=[]);const a=this._engine.images,i=e.shapeData;if(!i)return;const n=e.getFillColor(),s=a.find((t=>t.name===i.name||t.source===i.src));if(!s)return;const r=i.replaceColor??s.replaceColor;s.loading?setTimeout((()=>{this.particleInit(t,e)})):(async()=>{let t;t=s.svgData&&n?await(0,o.e)(s,i,n,e):{color:n,data:s,element:s.element,gif:s.gif,gifData:s.gifData,gifLoopCount:s.gifLoopCount,loaded:!0,ratio:i.width&&i.height?i.width/i.height:s.ratio??1,replaceColor:r,source:i.src},t.ratio||(t.ratio=1);const a={image:t,fill:i.fill??e.shapeFill,close:i.close??e.shapeClose};e.image=a.image,e.shapeFill=a.fill,e.shapeClose=a.close})()}}}}]);